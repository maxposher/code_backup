

--D1-14 GMV
SELECT  date(buyer.buyer_activated_at), 
        COUNT (distinct dw_orders.order_id) AS "Order Count",
        COUNT (distinct dw_orders.buyer_id) AS "Buyer Count", 
	COALESCE(SUM((dw_orders.order_gmv*0.01)), 0) AS "D1-14_GMV"
FROM  analytics.dw_users AS buyer
LEFT JOIN analytics.dw_orders AS dw_orders ON dw_orders.buyer_id = buyer.user_id
WHERE 
DATE(buyer.buyer_activated_at) >= '2014-01-01'
AND (DATEDIFF(day, (DATE(buyer.buyer_activated_at)), (DATE(dw_orders.booked_at))) + 1 between 2 and 14)
AND dw_orders.order_gmv*0.01 < 50000 and dw_orders.booked_at IS NOT NULL 
and dw_orders.order_state IN ('ab_captured', 'ab_captured_skipped', 'buyer_confirm_initiated', 'cancelled', 
'iu_status_update_failed', 'label_generate_failed', 'label_generated', 'seller_confirm_initiated', 'seller_kyc_verified', 
'seller_notification_initiated', 'waiting_seller_kyc_info', 'waiting_seller_zip', 'label_service_unavailable', 
'iu_status_updated', 'order_enqueued', 'order_enqueue_failed', 'seller_ab_updated', 'seller_ab_update_failed', 
'waiting_seller_kyc_verification') 
--and buyer.acq_channel not in ('rip')
and buyer.user_id     in (
                          SELECT *
                          FROM analytics_scratch.gdm_act_users 
                                                               )
GROUP BY 1
ORDER BY 1












SELECT    CASE
          when LOWER(acq_channel) = 'adaction interactive' then 'mobile_paid'
          when LOWER(acq_channel) = 'adcolony' then 'mobile_paid'
          when LOWER(acq_channel) = 'adparlor' then 'mobile_paid'
          when LOWER(acq_channel) = 'adperio' then 'mobile_paid'
          when LOWER(acq_channel) = 'advertising.com' then 'mobile_paid'
          when LOWER(acq_channel) = 'adxcel' then 'mobile_paid'
          when LOWER(acq_channel) = 'airpush' then 'mobile_paid'
          when LOWER(acq_channel) = 'altrooz' then 'mobile_paid'
          when LOWER(acq_channel) = 'altrooz - ios' then 'mobile_paid'
          when LOWER(acq_channel) = 'ampush' then 'mobile_paid'
          when LOWER(acq_channel) = 'apple iad' then 'mobile_paid'
          when LOWER(acq_channel) = 'applovin' then 'mobile_paid'
          when LOWER(acq_channel) = 'appnexus' then 'mobile_paid'
          when LOWER(acq_channel) = 'apsalar' then 'mobile_paid'
          when LOWER(acq_channel) = 'bdm' then 'seo_gks'
          when LOWER(acq_channel) = 'chirpads' then 'mobile_paid'
          when LOWER(acq_channel) = 'clicksmob' then 'mobile_paid'
          when LOWER(acq_channel) = 'cwgt' then 'mobile_organic'
          when LOWER(acq_channel) = 'dedicated media' then 'mobile_paid'
          when LOWER(acq_channel) = 'dedicated media - android' then 'mobile_paid'
          when LOWER(acq_channel) = 'direct agents' then 'mobile_paid'
          when LOWER(acq_channel) = 'drawbridge' then 'mobile_paid'
          when LOWER(acq_channel) = 'dt' then 'mobile_organic'
          when LOWER(acq_channel) = 'em_sh_pub' then 'mobile_paid'
          when LOWER(acq_channel) = 'ext_fb' then 'mobile_organic'
          when LOWER(acq_channel) = 'ext_gp' then 'mobile_organic'
          when LOWER(acq_channel) = 'ext_pi' then 'mobile_organic'
          when LOWER(acq_channel) = 'ext_pn' then 'mobile_organic'
          when LOWER(acq_channel) = 'ext_tm' then 'mobile_organic'
          when LOWER(acq_channel) = 'ext_tw' then 'mobile_organic'
          when LOWER(acq_channel) = 'Facebook' then 'mobile_paid'
          when LOWER(acq_channel) = 'facebook' then 'mobile_paid'
          when LOWER(acq_channel) = 'facebook android' then 'mobile_paid'
          when LOWER(acq_channel) = 'facebook ios' then 'mobile_paid'
          when LOWER(acq_channel) = 'facebookios' then 'mobile_paid'
          when LOWER(acq_channel) = 'famebit' then 'mobile_paid'
          when LOWER(acq_channel) = 'fb' then 'mobile_paid'
          when LOWER(acq_channel) = 'fb_beta' then 'mobile_paid'
          when LOWER(acq_channel) = 'fb_kshoo' then 'mobile_paid'
          when LOWER(acq_channel) = 'fb_retail' then 'mobile_paid'
          when LOWER(acq_channel) = 'fb_sh_msn' then 'mobile_paid'
          when LOWER(acq_channel) = 'fb_sh_pub' then 'mobile_paid'
          when LOWER(acq_channel) = 'fb_sokrati' then 'mobile_paid'
          when LOWER(acq_channel) = 'fbdm' then 'gdm_google_shopping'
          when LOWER(acq_channel) = 'fbretail' then 'mobile_paid'
          when LOWER(acq_channel) = 'february+2014' then 'mobile_organic'
          when LOWER(acq_channel) = 'flurry appcircle' then 'mobile_paid'
          when LOWER(acq_channel) = 'friend finder - sms' then 'mobile_organic'
          when LOWER(acq_channel) = 'gdm' then 'gdm_google_shopping'
          when LOWER(acq_channel) = 'getapp-mobile' then 'mobile_paid'
          when LOWER(acq_channel) = 'gks' then 'seo_gks'
          when LOWER(acq_channel) = 'glispa' then 'mobile_paid'
          when LOWER(acq_channel) = 'google adwords' then 'mobile_paid'
          when LOWER(acq_channel) = 'google adwords - ios' then 'mobile_paid'
          when LOWER(acq_channel) = 'googledisplay' then 'web_other'
          when LOWER(acq_channel) = 'googlesearch' then 'mobile_organic'
          when LOWER(acq_channel) = 'growmobile' then 'mobile_paid'
          when LOWER(acq_channel) = 'gs' then 'mobile_organic'
          when LOWER(acq_channel) = 'gshm' then 'web_other'
          when LOWER(acq_channel) = 'home page' then 'web_other'
          when LOWER(acq_channel) = 'homepage' then 'web_other'
          when LOWER(acq_channel) = 'iad' then 'mobile_paid'
          when LOWER(acq_channel) = 'ig_beta' then 'mobile_paid'
          when LOWER(acq_channel) = 'ig_kshoo' then 'mobile_paid'
          when LOWER(acq_channel) = 'ig_retail' then 'mobile_paid'
          when LOWER(acq_channel) = 'influencer 1' then 'mobile_paid'
          when LOWER(acq_channel) = 'influencer 2' then 'mobile_paid'
          when LOWER(acq_channel) = 'influencer 4' then 'mobile_paid'
          when LOWER(acq_channel) = 'influencer 5' then 'mobile_paid'
          when LOWER(acq_channel) = 'inmobi' then 'mobile_paid'
          when LOWER(acq_channel) = 'instagram' then 'mobile_paid'
          when LOWER(acq_channel) = 'intentbuy llc' then 'mobile_paid'
          when LOWER(acq_channel) = 'invfriendemail' then 'mobile_organic'
          when LOWER(acq_channel) = 'invfriendfb' then 'mobile_organic'
          when LOWER(acq_channel) = 'invfriendsms' then 'mobile_organic'
          when LOWER(acq_channel) = 'invfriendtu' then 'mobile_organic'
          when LOWER(acq_channel) = 'invfriendtw' then 'mobile_organic'
          when LOWER(acq_channel) = 'invitefriends-email' then 'mobile_organic'
          when LOWER(acq_channel) = 'invitefriends-fb' then 'mobile_organic'
          when LOWER(acq_channel) = 'invitefriends-sms' then 'mobile_organic'
          when LOWER(acq_channel) = 'invitefriends-tu' then 'mobile_organic'
          when LOWER(acq_channel) = 'invitefriends-tw' then 'mobile_organic'
          when LOWER(acq_channel) = 'iron source' then 'mobile_paid'
          when LOWER(acq_channel) = 'jumptap' then 'mobile_paid'
          when LOWER(acq_channel) = 'kixer inc.' then 'mobile_paid'
          when LOWER(acq_channel) = 'liftoff' then 'mobile_paid'
          when LOWER(acq_channel) = 'manage' then 'mobile_paid'
          when LOWER(acq_channel) = 'mdotm' then 'mobile_paid'
          when LOWER(acq_channel) = 'millennial media' then 'mobile_paid'
          when LOWER(acq_channel) = 'mobave' then 'mobile_paid'
          when LOWER(acq_channel) = 'mobvista' then 'mobile_paid'
          when LOWER(acq_channel) = 'motilityads' then 'mobile_paid'
          when LOWER(acq_channel) = 'motiveinteractive' then 'mobile_paid'
          when LOWER(acq_channel) = 'mpire' then 'mobile_paid'
          when LOWER(acq_channel) = 'mypoints' then 'mobile_organic'
          when LOWER(acq_channel) = 'na' then 'mobile_organic'
          when LOWER(acq_channel) = 'neverblue' then 'mobile_paid'
          when LOWER(acq_channel) = 'ntr' then 'mobile_organic'
          when LOWER(acq_channel) = 'ot' then 'mobile_organic'
          when LOWER(acq_channel) = 'pandora' then 'mobile_paid'
          when LOWER(acq_channel) = 'pi_sh_app' then 'mobile_paid'
          when LOWER(acq_channel) = 'pi_sh_pub' then 'mobile_paid'
          when LOWER(acq_channel) = 'pin_cpc' then 'mobile_paid'
          when LOWER(acq_channel) = 'pin_cpi' then 'mobile_paid'
          when LOWER(acq_channel) = 'pin_retail' then 'mobile_paid'
          when LOWER(acq_channel) = 'pinterest' then 'mobile_paid'
          when LOWER(acq_channel) = 'pinterestmob' then 'mobile_paid'
          when LOWER(acq_channel) = 'pinterestretail' then 'mobile_paid'
          when LOWER(acq_channel) = 'popsugar.com' then 'mobile_paid'
          when LOWER(acq_channel) = 'poshmark' then 'web_other'
          when LOWER(acq_channel) = 'pulsenews' then 'web_other'
          when LOWER(acq_channel) = 'pvrl' then 'mobile_organic'
          when LOWER(acq_channel) = 'reddit' then 'mobile_paid'
          when LOWER(acq_channel) = 'rip' then 'referral'
          when LOWER(acq_channel) = 'savingsmania+newsletter' then 'web_other'
          when LOWER(acq_channel) = 'searchman' then 'seo_gks'
          when LOWER(acq_channel) = 'sessionm' then 'mobile_paid'
          when LOWER(acq_channel) = 'shopzila' then 'seo_gks'
          when LOWER(acq_channel) = 'sitescout' then 'mobile_paid'
          when LOWER(acq_channel) = 'smsFF' then 'mobile_organic'
          when LOWER(acq_channel) = 'smsff' then 'mobile_organic'
          when LOWER(acq_channel) = 'spring+pop+up' then 'mobile_organic'
          when LOWER(acq_channel) = 'supersonicads' then 'mobile_paid'
          when LOWER(acq_channel) = 'tapcommerce' then 'mobile_paid'
          when LOWER(acq_channel) = 'tapjoy' then 'mobile_paid'
          when LOWER(acq_channel) = 'tapsense' then 'mobile_paid'
          when LOWER(acq_channel) = 'tapshop' then 'mobile_paid'
          when LOWER(acq_channel) = 'taptica' then 'mobile_paid'
          when LOWER(acq_channel) = 'thehunt.com' then 'mobile_paid'
          when LOWER(acq_channel) = 'tm' then 'mobile_paid'
          when LOWER(acq_channel) = 'tm_sh_pub' then 'mobile_paid'
          when LOWER(acq_channel) = 'tpn' then 'mobile_paid'
          when LOWER(acq_channel) = 'tumblr' then 'mobile_paid'
          when LOWER(acq_channel) = 'tw' then 'mobile_paid'
          when LOWER(acq_channel) = 'tw_comprendi' then 'mobile_paid'
          when LOWER(acq_channel) = 'tw_comprendi_tap' then 'mobile_paid'
          when LOWER(acq_channel) = 'tw_retail' then 'mobile_paid'
          when LOWER(acq_channel) = 'tw_tap' then 'mobile_paid'
          when LOWER(acq_channel) = 'twitter' then 'mobile_paid'
          When LOWER(acq_channel) = 'twitter - android' then 'mobile_paid'
          when LOWER(acq_channel) = 'twitter - ios' then 'mobile_paid'
          when LOWER(acq_channel) = 'twitter test' then 'mobile_paid'
          when LOWER(acq_channel) = 'twitter-android' then 'mobile_paid'
          when LOWER(acq_channel) = 'twitter-ios' then 'mobile_paid'
          when LOWER(acq_channel) = 'unknown' then 'mobile_organic'
          when LOWER(acq_channel) = 'vibrant media' then 'mobile_paid'
          when LOWER(acq_channel) = 'we heart it' then 'mobile_paid'
          when LOWER(acq_channel) = 'wheretoget.it' then 'mobile_paid'
          when LOWER(acq_channel) = 'yahoo ad manager' then 'mobile_paid'
          when LOWER(acq_channel) = 'yahoo web test' then 'mobile_paid'
          when LOWER(acq_channel) = 'ydm' then 'mobile_paid'
          when LOWER(acq_channel) = 'youappi' then 'mobile_paid'
          when LOWER(acq_channel) = 'zulily' then 'mobile_paid'
          when LOWER(acq_channel) = 'shopzilla' then 'mobile_paid'
          when LOWER(acq_channel) = 'get it' then 'mobile_paid'           
          when LOWER(acq_channel) = '' then 'mobile_organic'   
          when LOWER(acq_channel) = 'other' then 'mobile_organic'   
          when LOWER(acq_channel) is NULL then 'mobile_organic'
          when ((joined_at < '2014-10-01') and LOWER(acq_channel) = 'organic'    and reg_app in ('iphone', 'android', 'ipad') or reg_app is NULL) then 'mobile_organic'
          when ((joined_at < '2014-10-01') and LOWER(acq_channel) = 'other_paid' and reg_app in ('iphone', 'android', 'ipad') or reg_app is NULL) then 'mobile_paid'
          when ((joined_at < '2014-10-01') and LOWER(acq_channel) in ('organic','other_paid') and reg_app = 'web')                                  then 'web_other'
          ELSE 'Other' 
          END, 

        date(buyer.buyer_activated_at), 
        COUNT (distinct dw_orders.order_id) AS "Order Count",
        COUNT (distinct dw_orders.buyer_id) AS "Buyer Count", 
	COALESCE(SUM((dw_orders.order_gmv*0.01)), 0) AS "D2-7_GMV"
FROM  analytics.dw_users AS buyer
LEFT JOIN analytics.dw_orders AS dw_orders ON dw_orders.buyer_id = buyer.user_id
WHERE 
DATE(buyer.buyer_activated_at) >= '2014-01-01'
AND  DATE(dw_orders.booked_at) - DATE(buyer.buyer_activated_at) + 1 <= 7
AND dw_orders.order_gmv*0.01 < 50000 and dw_orders.booked_at IS NOT NULL 
and dw_orders.order_state IN ('ab_captured', 'ab_captured_skipped', 'buyer_confirm_initiated', 'cancelled', 
'iu_status_update_failed', 'label_generate_failed', 'label_generated', 'seller_confirm_initiated', 'seller_kyc_verified', 
'seller_notification_initiated', 'waiting_seller_kyc_info', 'waiting_seller_zip', 'label_service_unavailable', 
'iu_status_updated', 'order_enqueued', 'order_enqueue_failed', 'seller_ab_updated', 'seller_ab_update_failed', 
'waiting_seller_kyc_verification') 
--and buyer.acq_channel not in ('rip')
--and buyer.user_id  not in (
--                          SELECT *
 --                         FROM analytics_scratch.gdm_act_users 
 --                                                              )
GROUP BY 1,2
ORDER BY 2







------------------------------------------------------------------------
------------------------------------------------------------------------
------------------------------------------------------------------------




SELECT
Case when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'adaction interactive' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'adcolony' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'adparlor' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'adperio' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'advertising.com' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'adxcel' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'airpush' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'altrooz' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'altrooz - ios' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ampush' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'apple iad' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'applovin' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'appnexus' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'apsalar' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'bdm' then 'seo_gks' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'chirpads' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'clicksmob' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'cwgt' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'dedicated media' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'dedicated media - android' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'direct agents' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'drawbridge' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'dt' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'em_sh_pub' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ext_fb' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ext_gp' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ext_pi' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ext_pn' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ext_tm' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ext_tw' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'Facebook' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'facebook' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'facebook android' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'facebook ios' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'facebookios' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'famebit' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'fb' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'fb_beta' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'fb_kshoo' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'fb_retail' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'fb_sh_msn' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'fb_sh_pub' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'fb_sokrati' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'fbdm' then 'gdm_google_shopping' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'fbretail' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'february+2014' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'flurry appcircle' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'friend finder - sms' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'gdm' then 'gdm_google_shopping' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'getapp-mobile' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'gks' then 'seo_gks' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'glispa' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'google adwords' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'google adwords - ios' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'googledisplay' then 'web_other' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'googlesearch' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'growmobile' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'gs' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'gshm' then 'web_other' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'home page' then 'web_other' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'homepage' then 'web_other' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'iad' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ig_beta' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ig_kshoo' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ig_retail' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'influencer 1' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'influencer 2' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'influencer 4' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'influencer 5' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'inmobi' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'instagram' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'intentbuy llc' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'invfriendemail' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'invfriendfb' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'invfriendsms' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'invfriendtu' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'invfriendtw' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'invitefriends-email' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'invitefriends-fb' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'invitefriends-sms' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'invitefriends-tu' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'invitefriends-tw' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'iron source' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'jumptap' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'kixer inc.' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'liftoff' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'manage' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'mdotm' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'millennial media' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'mobave' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'mobvista' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'motilityads' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'motiveinteractive' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'mpire' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'mypoints' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'na' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'neverblue' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ntr' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ot' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pandora' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pi_sh_app' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pi_sh_pub' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pin_cpc' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pin_cpi' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pin_retail' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pinterest' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pinterestmob' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pinterestretail' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'popsugar.com' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'poshmark' then 'web_other' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pulsenews' then 'web_other' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'pvrl' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'reddit' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'rip' then 'referral' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'savingsmania+newsletter' then 'web_other' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'searchman' then 'seo_gks' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'sessionm' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'shopzila' then 'seo_gks' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'sitescout' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'smsFF' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'smsff' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'spring+pop+up' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'supersonicads' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tapcommerce' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tapjoy' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tapsense' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tapshop' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'taptica' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'thehunt.com' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tm' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tm_sh_pub' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tpn' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tumblr' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tw' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tw_comprendi' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tw_comprendi_tap' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tw_retail' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'tw_tap' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'twitter' then 'mobile_paid' When (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'twitter - android' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'twitter - ios' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'twitter test' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'twitter-android' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'twitter-ios' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'unknown' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'vibrant media' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'we heart it' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'wheretoget.it' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'yahoo ad manager' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'yahoo web test' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'ydm' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'youappi' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'zulily' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'shopzilla' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'get it' then 'mobile_paid' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = '' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'other' then 'mobile_organic' when (CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) is NULL then 'mobile_organic' when ((buyer.joined_at < '2014-10-01') and ((CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'organic')    and (buyer.reg_app in ('iphone', 'android', 'ipad') or (buyer.reg_app is NULL))) then 'mobile_organic' when ((buyer.joined_at < '2014-10-01') and ((CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) = 'other_paid') and (buyer.reg_app in ('iphone', 'android', 'ipad') or (buyer.reg_app is NULL))) then 'mobile_paid' when ((buyer.joined_at < '2014-10-01') and ((CASE WHEN (buyer.joined_at < '2014-10-01' and buyer.acq_channel not in ('rip')) THEN buyer.heuristical_acq_channel WHEN buyer.acq_channel IN ('rip') OR buyer.is_referred_with_code in ('Yes') THEN 'rip' ELSE buyer.acq_channel END) in ('organic','other_paid')) and (buyer.reg_app = 'web')) then 'web_other' ELSE 'Other' END AS "buyer.acq_channel_super_group"
   ,date(buyer.buyer_activated_at), 
        COUNT (distinct dw_orders.order_id) AS "Order Count",
        COUNT (distinct dw_orders.buyer_id) AS "Buyer Count", 
	COALESCE(SUM((dw_orders.order_gmv*0.01)), 0) AS "D2-7_GMV"
FROM  analytics.dw_users AS buyer
LEFT JOIN analytics.dw_orders AS dw_orders ON dw_orders.buyer_id = buyer.user_id
WHERE 
DATE(buyer.buyer_activated_at) >= '2014-01-01'
AND  DATE(dw_orders.booked_at) - DATE(buyer.buyer_activated_at) + 1 BETWEEN 1 and 14
AND dw_orders.order_gmv*0.01 < 50000 and dw_orders.booked_at IS NOT NULL 
and dw_orders.order_state IN ('ab_captured', 'ab_captured_skipped', 'buyer_confirm_initiated', 'cancelled', 
'iu_status_update_failed', 'label_generate_failed', 'label_generated', 'seller_confirm_initiated', 'seller_kyc_verified', 
'seller_notification_initiated', 'waiting_seller_kyc_info', 'waiting_seller_zip', 'label_service_unavailable', 
'iu_status_updated', 'order_enqueued', 'order_enqueue_failed', 'seller_ab_updated', 'seller_ab_update_failed', 
'waiting_seller_kyc_verification') 
--and buyer.acq_channel not in ('rip')
and buyer.user_id     not in (
                          SELECT *
                          FROM analytics_scratch.gdm_act_users 
                                                               )
GROUP BY 1,2
ORDER BY 2



